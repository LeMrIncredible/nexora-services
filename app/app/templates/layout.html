{#
 Base layout for Nexora.

 Includes Bootstrap CSS/JS and a top navigation bar that adapts
 depending on whether the user is authenticated and their role.
#}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}Nexora{% endblock %}</title>
    <!-- Import Nexora fonts and Tailwind CSS to match the marketing site -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      /* Extend Tailwind theme with Nexora colours.  These values mirror the marketing site
         palette defined in public/index.html.  Using the same palette ensures the portal
         shares the same look and feel as the website. */
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              nexora: {
                primary: '#CCFF00',
                primaryDim: 'rgba(204,255,0,0.1)',
                accent: '#3b82f6',
                text: '#f4f4f5',
                muted: '#a1a1aa',
                dark: '#050505',
                surface: '#0A0A0A'
              }
            }
          }
        }
      };
    </script>
    <style>
      body {
        background-color: #050505;
        color: #f4f4f5;
        font-family: 'Inter', sans-serif;
      }

      /* Minimal Bootstrap grid fallback for legacy templates.  Many portal
         templates still use `.row` and `.col-md-*` classes.  Define a
         simple flexbox grid so they don't break when Bootstrap is removed. */
      .row {
        display: flex;
        flex-wrap: wrap;
        margin-left: -0.5rem;
        margin-right: -0.5rem;
      }
      [class^="col-"], [class*=" col-"] {
        padding-left: 0.5rem;
        padding-right: 0.5rem;
      }
      .col-md-6 { flex: 0 0 50%; max-width: 50%; }
      .col-md-8 { flex: 0 0 66.666667%; max-width: 66.666667%; }
      .col-md-4 { flex: 0 0 33.333333%; max-width: 33.333333%; }
      .col-md-12 { flex: 0 0 100%; max-width: 100%; }
    </style>
  </head>
  <body>
    <!-- Top navigation bar using Tailwind classes.  Colours and spacing mirror the marketing site -->
    <nav class="bg-nexora-dark text-nexora-text">
      <div class="container mx-auto px-4 py-4 flex items-center justify-between">
        <a class="text-xl font-semibold" href="{{ url_for('client.dashboard') if current_user.is_authenticated and current_user.is_client_user() else (url_for('admin.dashboard') if current_user.is_authenticated and current_user.is_admin() else url_for('auth.login')) }}">Nexora</a>
        <div>
          <ul class="flex space-x-4 items-center">
            {% if current_user.is_authenticated %}
              {% if current_user.is_admin() %}
                <li><a class="hover:text-nexora-primary" href="{{ url_for('admin.dashboard') }}">Admin Dashboard</a></li>
                <li><a class="hover:text-nexora-primary" href="{{ url_for('admin.clients') }}">Clients</a></li>
              {% else %}
                <li><a class="hover:text-nexora-primary" href="{{ url_for('client.dashboard') }}">Dashboard</a></li>
                <li><a class="hover:text-nexora-primary" href="{{ url_for('client.leads') }}">Leads</a></li>
                <li><a class="hover:text-nexora-primary" href="{{ url_for('client.jobs') }}">Jobs</a></li>
                <li><a class="hover:text-nexora-primary" href="{{ url_for('client.logs') }}">Logs</a></li>
                <li><a class="hover:text-nexora-primary" href="{{ url_for('client.settings') }}">Settings</a></li>
              {% endif %}
              <li><a class="hover:text-nexora-primary" href="{{ url_for('auth.logout') }}">Logout</a></li>
            {% else %}
              <li><a class="hover:text-nexora-primary" href="{{ url_for('auth.login') }}">Login</a></li>
            {% endif %}
          </ul>
        </div>
      </div>
    </nav>
    <div class="container mx-auto px-4 py-6">
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
            {% if category == 'success' %}
              <div class="mb-4 p-3 bg-green-600/20 text-green-200 rounded">{{ message }}</div>
            {% elif category == 'danger' %}
              <div class="mb-4 p-3 bg-red-600/20 text-red-200 rounded">{{ message }}</div>
            {% else %}
              <div class="mb-4 p-3 bg-nexora-primaryDim text-nexora-text rounded">{{ message }}</div>
            {% endif %}
          {% endfor %}
        {% endif %}
      {% endwith %}
      {% block content %}{% endblock %}
    </div>
  </body>
</html>